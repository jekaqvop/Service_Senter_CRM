import React, { useEffect, useState } from 'react'
import axios from '../api/axios';
import ServiceItem from '../components/ServiceItem';
import "./CSS/Services.css"
import 'bulma/css/bulma.css';
import Button from '@material-ui/core/Button';
import AddServices from '../components/AddService/AddService';
import Preloader from '../components/Preloader/Preloader';

const SERVICES_URL = "/api/Services"

const MainPage = (props) =>{
    const [loading, setLoading] = useState(false);
    const [services, setServices] = useState([]);
    const loadServices = async (e) => {
      try{
         const response = await axios.get(
            SERVICES_URL,
            {
              headers: { 'Content-Type': 'application/json' },
              withCredentials: true,
            }
        );  
        setServices(response.data);          
        setLoading(false);   
      }catch(err){
        setLoading(false);
      }         
    };
    useEffect(()=>{
        setLoading(true);          
        loadServices();       
       }, []);

       const showToastFiveSec = (type, description) =>{
   
        props.showToast(type, "top-right", true, 5000, !description ? "Error" : description);
      }

       return(
        <>
            {loading ? (
            <Preloader/>) : (
            <> 
                  <div id="bagroundBlue" className="hero is-primary">
              <div className="hero-body container">
                <h4 className="title">Предоставляемые услуги</h4>
              </div>
            </div>
            <br />
            <div className="container">
              <div className="column columns is-multiline">
             
                {services && services.length ? (
                  services.map((service, index) => (
                    <ServiceItem
                      product={service}
                      key={index}
                      addToCart={()=> console.log("adding")}
                    />
                  ))
                ) : (
                  <div className="column">
                    <span className="title has-text-grey-light">
                      Услуги не найдены
                    </span>
                  </div>
                )}
              </div>
            </div> 
            </>
            )
            }
        </>
       );
}


export default MainPage;
